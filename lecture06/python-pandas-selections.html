
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Selecting dataframe rows that satisfy a boolean expression &#8212; Introduction to Data Science for Mechanical Engineers (Lecture Book)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lecture06/python-pandas-selections';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Homework 6" href="homework_06.html" />
    <link rel="prev" title="Python loops" href="python-loops.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Introduction to Data Science for Mechanical Engineers (Lecture Book)</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Preface
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecture01/intro.html">Lecture 1: Introduction</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecture01/what-is-data-science.html">What is data science?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture01/cool-applications.html">Some cool appliations of data science in mechanical engineering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture01/python-intro.html">Why Python?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture01/python-expressions.html">Python expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture01/python-variables-and-types.html">Python variables and types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture01/homework_01.html">Homework 1</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecture02/intro.html">Lecture 2: Data arrays</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecture02/python-tuples.html">Python tuples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture02/python-lists.html">Python lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture02/python-numpy.html">Numerical Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture02/homework_02.html">Homework 2</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecture03/intro.html">Lecture 3: Data loading and selection</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecture03/python-matrices.html">Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture03/python-csv-files.html">Comma-separated values file format</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture03/python-pandas.html">The Python Data Analysis Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture03/homework_03.html">Homework 3</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecture04/intro.html">Lecture 4: Data visualization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecture04/python-plotting.html">Plotting simple functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture04/python-plot-noisy.html">Plotting noisy measurements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture04/python-scatter.html">Scatter plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture04/python-histograms.html">Histograms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture04/homework_04.html">Homework 4</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecture05/intro.html">Lecture 5: Functions, data manipulation, and models</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecture05/python-strings.html">Basics of strings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture05/python-print.html">The print function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture05/python-functions.html">Python functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture05/applying-functions-to-dataframes.html">Applying functions to dataframes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture05/models-are-functions.html">Models are functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture05/homework_05.html">Homework 5</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="intro.html">Lecture 6: Conditionals and loops</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="python-conditionals.html">Python conditionals</a></li>
<li class="toctree-l2"><a class="reference internal" href="python-loops.html">Python loops</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Selecting dataframe rows that satisfy a boolean expression</a></li>
<li class="toctree-l2"><a class="reference internal" href="homework_06.html">Homework 6</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecture07/intro.html">Lecture 7: Probability as a measure of uncertainty</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecture07/probability-and-state-of-knowledge.html">Probability as a representation of our state of knowledge</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture07/probability-common-sense.html">The common sense assumptions that give rise to the basic probability rules.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture07/principle-of-insufficient-reason.html">The principle of insufficient reason</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture07/estimating-probabilities-by-simulation.html">Estimating probabilities by simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture07/estimating-probabilities-from-data.html">Estimating probabilities from data - Bootstrapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture07/homework_07.html">Homework 7</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecture08/intro.html">Lecture 8: The basic rules of probability</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecture08/probability-rules.html">The basic rules of probability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture08/probability-urn-example.html">Example - Drawing balls from a box without replacement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture08/probability-of-disjunction.html">Probability of logical disjunctions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture08/probability-sum-rule.html">The sum rule</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture08/probability-urn-example-sum-rule.html">Example - Drawing balls from a box without replacement (sum rule)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture08/probability-urn-example-information-flow.html">Example - Drawing balls from a box without replacement (information flow)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture08/homework_08.html">Homework 8</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecture09/intro.html">Lecture 9: Discrete random variables</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecture09/discrete-random-variables.html">Discrete Random variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture09/probability-mass-function.html">The probability mass function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture09/the-bernoulli-distribution.html">The Bernoulli distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture09/properties-of-the-probability-mass-function.html">Properties of the probability mass function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture09/the-categorical-distribution.html">The Categorical distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture09/the-binomial-distribution.html">The Binomial Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture09/the-poisson-distribution.html">The Poisson distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture09/homework_09.html">Homework 9</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecture10/intro.html">Lecture 10: Continuous random variables</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecture10/continuous-random-variables.html">Continuous random variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture10/example-manufacturing-steel-balls.html">Example: Uncertainties in steel ball manufacturing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture10/cumulative-distribution-function.html">The cumulative distribution function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture10/probability-density-function.html">The probability density function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture10/the-uniform-distribution.html">The uniform distribution</a></li>

<li class="toctree-l2"><a class="reference internal" href="../lecture10/homework_10.html">Homework 10</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecture11/intro.html">Lecture 11: Expectations, variances, and their properties</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecture11/expectation-discrete-rv.html">Expectation of discrete random variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture11/examples-expectation-of-discrete-rvs.html">Examples of expectations of discrete random variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture11/expectation-continuous-rv.html">Expectation of a continuous random variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture11/expectation-notation.html">Simplifying our notation about expectations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture11/properties-of-expectations.html">Properties of expectations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture11/variance.html">Variance of a random variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture11/properties-of-variance.html">Properties of variance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture11/examples-variance.html">Examples of variances of random variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture11/homework_11.html">Homework 11</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecture12/intro.html">Lecture 12: The Normal distribution, quantiles, and credible intervals</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecture12/the-standard-normal.html">The standard Normal distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture12/standard-normal-quantiles.html">Quantiles of the standard Normal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture12/the-normal.html">The Normal distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture12/normal-quantiles.html">Quantiles of the Normal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture12/example-fitting-normals.html">Fitting Normal distributions to data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture12/homework_12.html">Homework 12</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecture13/intro.html">Lecture 13: Fitting models with the principle of maximum likelihood</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecture13/joint-probability-density-function.html">The joint probability density function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture13/repeated-experiments.html">Repeated independent experiments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture13/the-maximum-likelihood-principle.html">The maximum likelihood principle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture13/fitting-the-normal-with-maximum-likelihood.html">Fitting the parameters of a Normal using the maximum likelihood principle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture13/fitting-the-bernoulli.html">Fitting the Bernoulli with maximum likelihood</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture13/predictive-checking.html">Predictive checking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture13/homework_13.html">Homework 13</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecture14/intro.html">Lecture 14: Covariance, correlation, and linear regression with one variable</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecture14/covariance.html">Covariance between two random variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture14/correlation.html">Correlation between two random variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture14/correlation-is-not-causation.html">Correlation is not causation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture14/uncorrelated-does-not-imply-independent.html">Two uncorrelated random variables are not necessarily independent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture14/linear-regression-with-one-variable.html">Linear regression with one variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture14/homework_14.html">Homework 14</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecture15/intro.html">Lecture 15: Linear regression</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecture15/regression-with-one-variable-revisited.html">Regression with one variable revisited</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture15/example-linear-regression.html">Example: Linear regression with a single variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture15/polynomial-regression.html">Polynomial Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture15/the-generalized-linear-model.html">The generalized linear model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture15/regression-diagnostics.html">Measures of Predictive Accuracy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture15/cross-validation.html">Cross validation for selecting the number of basis functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture15/maximum-likelihood-interpretation.html">Maximum likelihood interpretation of least squares</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture15/maximum-likelihood-example.html">Example: Regression with estimated measurement noise</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture15/homework_15.html">Homework 15</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lecture16/intro.html">Lecture 16: Classification via logistic regression</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lecture16/logistic-regression.html">Logistic regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture16/example-logistic-regression-one-variable.html">Example: Logistic regression with one variable (High melting explosives)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture16/example-logistic-regression-many-features.html">Logistic regression with many features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture16/classification-diagnostics.html">Diagnostics for Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lecture16/homework_16.html">Homework 16</a></li>

</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/PurdueMechanicalEngineering/me-239-intro-to-data-science/master?urlpath=lab/tree/lecture06/python-pandas-selections.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/PurdueMechanicalEngineering/me-239-intro-to-data-science/blob/master/lecture06/python-pandas-selections.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/lecture06/python-pandas-selections.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Selecting dataframe rows that satisfy a boolean expression</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-rows-that-satisfy-single-boolean-expression">Extract rows that satisfy single boolean expression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#questions">Questions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-timeseries-data">Plotting timeseries data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Questions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#avoid-writing-a-lot-of-code-by-using-loops">Avoid writing a lot of code by using loops</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Questions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-rows-that-satisfy-more-complicated-boolean-expressions">Extract rows that satisfy more complicated boolean expressions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Questions</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="selecting-dataframe-rows-that-satisfy-a-boolean-expression">
<span id="lecture06-selecting-rows"></span><h1>Selecting dataframe rows that satisfy a boolean expression<a class="headerlink" href="#selecting-dataframe-rows-that-satisfy-a-boolean-expression" title="Link to this heading">#</a></h1>
<p>We are now going to put to use what we learned about Python boolean expressions to extract rows from a dataframe that satisfy certain criteria.</p>
<section id="extract-rows-that-satisfy-single-boolean-expression">
<h2>Extract rows that satisfy single boolean expression<a class="headerlink" href="#extract-rows-that-satisfy-single-boolean-expression" title="Link to this heading">#</a></h2>
<p>Let’s do this by example.
Let’s load again the <code class="docutils literal notranslate"><span class="pre">temperature_raw.xlsx</span></code> dataset we played with in <a class="reference internal" href="../lecture05/models-are-functions.html#lecture05-models-are-functions"><span class="std std-ref">Models are functions</span></a>.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">rc</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;figure.dpi&quot;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;savefig.dpi&#39;</span><span class="p">:</span><span class="mi">300</span><span class="p">})</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">&#39;notebook&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;ticks&quot;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">set_matplotlib_formats</span>
<span class="n">set_matplotlib_formats</span><span class="p">(</span><span class="s1">&#39;retina&#39;</span><span class="p">,</span> <span class="s1">&#39;svg&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="k">def</span> <span class="nf">download</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">local_filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Downloads the file in the ``url`` and saves it in the current working directory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">local_filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">local_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">local_filename</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fd</span><span class="p">:</span>
        <span class="n">fd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
   
<span class="c1"># The url of the file we want to download</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/PurdueMechanicalEngineering/me-297-intro-to-data-science/master/data/temperature_raw.xlsx&#39;</span>
<span class="n">download</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;temperature_raw.xlsx&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>household</th>
      <th>date</th>
      <th>score</th>
      <th>t_out</th>
      <th>t_unit</th>
      <th>hvac</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a1</td>
      <td>2018-01-07</td>
      <td>100.0</td>
      <td>4.283373</td>
      <td>66.693229</td>
      <td>246.473231</td>
    </tr>
    <tr>
      <th>1</th>
      <td>a10</td>
      <td>2018-01-07</td>
      <td>100.0</td>
      <td>4.283373</td>
      <td>66.356134</td>
      <td>5.492116</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a11</td>
      <td>2018-01-07</td>
      <td>58.0</td>
      <td>4.283373</td>
      <td>71.549132</td>
      <td>402.094327</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a12</td>
      <td>2018-01-07</td>
      <td>64.0</td>
      <td>4.283373</td>
      <td>73.429514</td>
      <td>211.692244</td>
    </tr>
    <tr>
      <th>4</th>
      <td>a13</td>
      <td>2018-01-07</td>
      <td>100.0</td>
      <td>4.283373</td>
      <td>63.923937</td>
      <td>0.850536</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Recall that we made a simple model between the weekly average of the consumed energy in kWh <code class="docutils literal notranslate"><span class="pre">hvac</span></code> and the average weekly external temperature <code class="docutils literal notranslate"><span class="pre">t_out</span></code>.
The model was:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">hvac_model</span><span class="p">(</span><span class="n">t_out</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">t_out_min</span><span class="o">=</span><span class="mi">60</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A naïve model of weekly HVAC energy consumption (kWh) as a function of external temperature t_out.</span>
<span class="sd">    The mathematical form of the model is:</span>
<span class="sd">    </span>
<span class="sd">        hvac = a * (t_out - t_out_min)^2 + b</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    t_out      -   The average external temperature in degrees F (average over a week).</span>
<span class="sd">    a          -   A parameter to be calibrated using observed data. In units of kWh / (deg F)^2.</span>
<span class="sd">    b          -   Another parameter to be calibrated using observed data. This is in units of kWh.</span>
<span class="sd">                   It is the energy consumption when the HVAC system is not used.</span>
<span class="sd">    t_out_min  -   The external temperature above at which the occupants feel comfortable without using</span>
<span class="sd">                   their HVAC system.</span>
<span class="sd">    </span>
<span class="sd">    Returns: The weekly HVAC energy consumption in kWh.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">t_out</span> <span class="o">-</span> <span class="n">t_out_min</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">b</span>
</pre></div>
</div>
</div>
</div>
<p>and the predictions looked like this:</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">a</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># in kWh / F^2</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">50</span> <span class="c1"># in kWh</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># First the scatter plot of all the data we have</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;hvac&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Observed data&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t_out (F)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;hvac (kWh)&#39;</span><span class="p">)</span>

<span class="c1"># Now pick some temperatures to use our model on:</span>
<span class="n">t_outs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">predicted_hvac</span> <span class="o">=</span> <span class="n">hvac_model</span><span class="p">(</span><span class="n">t_outs</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_outs</span><span class="p">,</span> <span class="n">predicted_hvac</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Model predictons&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/3e8df721479ec0e0c712797ea031f4245c71b78418f51b3d8536f0c0962d368f.svg" src="../_images/3e8df721479ec0e0c712797ea031f4245c71b78418f51b3d8536f0c0962d368f.svg" />
</div>
</div>
<p>Clearly, this model represents some sort of average behavior.
Let’s use see how specific households perform.
Here is how many households we have:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;household&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;a1&#39;, &#39;a10&#39;, &#39;a11&#39;, &#39;a12&#39;, &#39;a13&#39;, &#39;a16&#39;, &#39;a2&#39;, &#39;a3&#39;, &#39;a4&#39;, &#39;a5&#39;,
       &#39;a6&#39;, &#39;a7&#39;, &#39;a8&#39;, &#39;a9&#39;, &#39;b17&#39;, &#39;b18&#39;, &#39;b19&#39;, &#39;b20&#39;, &#39;b21&#39;, &#39;b22&#39;,
       &#39;b23&#39;, &#39;b24&#39;, &#39;b25&#39;, &#39;b26&#39;, &#39;b28&#39;, &#39;b29&#39;, &#39;b30&#39;, &#39;b31&#39;, &#39;b33&#39;,
       &#39;c34&#39;, &#39;c35&#39;, &#39;c36&#39;, &#39;c37&#39;, &#39;c38&#39;, &#39;c39&#39;, &#39;c40&#39;, &#39;c41&#39;, &#39;c42&#39;,
       &#39;c43&#39;, &#39;c44&#39;, &#39;c45&#39;, &#39;c46&#39;, &#39;c47&#39;, &#39;c48&#39;, &#39;c49&#39;, &#39;c50&#39;, &#39;a15&#39;,
       &#39;a14&#39;, &#39;b32&#39;, &#39;b27&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>How can we extract the data for say household <code class="docutils literal notranslate"><span class="pre">a1</span></code>?
You can do it as follows.
First, notice that you can use a boolean expression directly on the column <code class="docutils literal notranslate"><span class="pre">household</span></code>.
The result is an an array with <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code> indicating the value of the boolean expression on the corresponding rows.
Here it is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;household&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;a1&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0        True
1       False
2       False
3       False
4       False
        ...  
5643    False
5644    False
5646    False
5647    False
5649    False
Name: household, Length: 4887, dtype: bool
</pre></div>
</div>
</div>
</div>
<p>Now, if you feed this array of booleans to the dataframe, it will understand that you only want to keep the rows that are <code class="docutils literal notranslate"><span class="pre">True</span></code>.
Here it is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;household&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;a1&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>household</th>
      <th>date</th>
      <th>score</th>
      <th>t_out</th>
      <th>t_unit</th>
      <th>hvac</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a1</td>
      <td>2018-01-07</td>
      <td>100.0</td>
      <td>4.283373</td>
      <td>66.693229</td>
      <td>246.473231</td>
    </tr>
    <tr>
      <th>50</th>
      <td>a1</td>
      <td>2018-01-14</td>
      <td>98.0</td>
      <td>33.444172</td>
      <td>67.812649</td>
      <td>116.952821</td>
    </tr>
    <tr>
      <th>100</th>
      <td>a1</td>
      <td>2018-01-21</td>
      <td>100.0</td>
      <td>19.584102</td>
      <td>66.512783</td>
      <td>116.128585</td>
    </tr>
    <tr>
      <th>150</th>
      <td>a1</td>
      <td>2018-01-28</td>
      <td>96.0</td>
      <td>41.076513</td>
      <td>69.575546</td>
      <td>61.086148</td>
    </tr>
    <tr>
      <th>200</th>
      <td>a1</td>
      <td>2018-02-04</td>
      <td>96.0</td>
      <td>30.065774</td>
      <td>70.085743</td>
      <td>61.349374</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4700</th>
      <td>a1</td>
      <td>2019-10-27</td>
      <td>97.0</td>
      <td>54.829439</td>
      <td>73.619056</td>
      <td>8.560911</td>
    </tr>
    <tr>
      <th>4750</th>
      <td>a1</td>
      <td>2019-11-03</td>
      <td>98.0</td>
      <td>45.925446</td>
      <td>72.456811</td>
      <td>14.331006</td>
    </tr>
    <tr>
      <th>4800</th>
      <td>a1</td>
      <td>2019-11-10</td>
      <td>97.0</td>
      <td>40.175345</td>
      <td>72.450988</td>
      <td>10.756552</td>
    </tr>
    <tr>
      <th>4850</th>
      <td>a1</td>
      <td>2019-11-17</td>
      <td>99.0</td>
      <td>32.199504</td>
      <td>71.451835</td>
      <td>11.828865</td>
    </tr>
    <tr>
      <th>4900</th>
      <td>a1</td>
      <td>2019-11-24</td>
      <td>97.0</td>
      <td>39.327257</td>
      <td>70.896187</td>
      <td>8.457236</td>
    </tr>
  </tbody>
</table>
<p>82 rows × 6 columns</p>
</div></div></div>
</div>
<p>So, there are 82 rows corresponding to this household.
If you wanted to find rows of another household, say <code class="docutils literal notranslate"><span class="pre">b17</span></code>, you do this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;household&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;b17&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>household</th>
      <th>date</th>
      <th>score</th>
      <th>t_out</th>
      <th>t_unit</th>
      <th>hvac</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>16</th>
      <td>b17</td>
      <td>2018-01-07</td>
      <td>73.0</td>
      <td>4.283373</td>
      <td>74.913484</td>
      <td>330.891743</td>
    </tr>
    <tr>
      <th>66</th>
      <td>b17</td>
      <td>2018-01-14</td>
      <td>70.0</td>
      <td>33.444172</td>
      <td>75.113492</td>
      <td>163.867247</td>
    </tr>
    <tr>
      <th>116</th>
      <td>b17</td>
      <td>2018-01-21</td>
      <td>69.0</td>
      <td>19.584102</td>
      <td>74.962054</td>
      <td>296.645428</td>
    </tr>
    <tr>
      <th>166</th>
      <td>b17</td>
      <td>2018-01-28</td>
      <td>70.0</td>
      <td>41.076513</td>
      <td>74.628770</td>
      <td>146.174333</td>
    </tr>
    <tr>
      <th>216</th>
      <td>b17</td>
      <td>2018-02-04</td>
      <td>79.0</td>
      <td>30.065774</td>
      <td>74.340575</td>
      <td>244.354832</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5416</th>
      <td>b17</td>
      <td>2020-02-02</td>
      <td>92.0</td>
      <td>33.655308</td>
      <td>70.938269</td>
      <td>101.666995</td>
    </tr>
    <tr>
      <th>5466</th>
      <td>b17</td>
      <td>2020-02-09</td>
      <td>95.0</td>
      <td>38.123983</td>
      <td>71.553150</td>
      <td>109.245547</td>
    </tr>
    <tr>
      <th>5516</th>
      <td>b17</td>
      <td>2020-02-16</td>
      <td>92.0</td>
      <td>28.548760</td>
      <td>71.428274</td>
      <td>182.109547</td>
    </tr>
    <tr>
      <th>5566</th>
      <td>b17</td>
      <td>2020-02-23</td>
      <td>92.0</td>
      <td>33.930233</td>
      <td>69.286012</td>
      <td>139.912270</td>
    </tr>
    <tr>
      <th>5616</th>
      <td>b17</td>
      <td>2020-02-25</td>
      <td>95.0</td>
      <td>43.642388</td>
      <td>72.251038</td>
      <td>8.293659</td>
    </tr>
  </tbody>
</table>
<p>113 rows × 6 columns</p>
</div></div></div>
</div>
<p>So, we have 113 rows for household <code class="docutils literal notranslate"><span class="pre">b17</span></code>.
The difference in the entries is likely due to sensor malfunction.
Now, let’s redo our scatter plot but using different colors for <code class="docutils literal notranslate"><span class="pre">a1</span></code> and <code class="docutils literal notranslate"><span class="pre">b17</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># First the scatter plot of all the data we have.</span>
<span class="c1"># Notice the keyword argument aplha=0.25. This makes the points transparent.</span>
<span class="c1"># alpha=1 means opaque and alpha=0 means invisible. So, something in between</span>
<span class="c1"># is transparent.</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;hvac&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;All households&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>

<span class="c1"># Do the scatter plot for a1</span>
<span class="n">a1_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;household&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;a1&#39;</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">a1_df</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">],</span> <span class="n">a1_df</span><span class="p">[</span><span class="s1">&#39;hvac&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Household a1&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="c1"># and the scatter plot for b17</span>
<span class="n">b17_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;household&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;b17&#39;</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">b17_df</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">],</span> <span class="n">b17_df</span><span class="p">[</span><span class="s1">&#39;hvac&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Household b17&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># The labels</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t_out (F)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;hvac (kWh)&#39;</span><span class="p">)</span>

<span class="c1"># Plot also our model.</span>
<span class="n">predicted_hvac</span> <span class="o">=</span> <span class="n">hvac_model</span><span class="p">(</span><span class="n">t_outs</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_outs</span><span class="p">,</span> <span class="n">predicted_hvac</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Model predictons&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b3b1a95777afad79eb936db069d85a51bd393beade4e4a41af1f8092c10fcb43.svg" src="../_images/b3b1a95777afad79eb936db069d85a51bd393beade4e4a41af1f8092c10fcb43.svg" />
</div>
</div>
<section id="questions">
<h3>Questions<a class="headerlink" href="#questions" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Modify the plot above to add data from household <code class="docutils literal notranslate"><span class="pre">c36</span></code>.</p></li>
</ul>
</section>
</section>
<section id="plotting-timeseries-data">
<h2>Plotting timeseries data<a class="headerlink" href="#plotting-timeseries-data" title="Link to this heading">#</a></h2>
<p>Since we have extracted the data for units <code class="docutils literal notranslate"><span class="pre">a1</span></code> and <code class="docutils literal notranslate"><span class="pre">b17</span></code>, we have a good opportunity to demonstrate another set of useful plots that you can do with dataframes.
We can now plot <code class="docutils literal notranslate"><span class="pre">t_unit</span></code> as a function of the <code class="docutils literal notranslate"><span class="pre">date</span></code> for each one of these units.
Let’s do it step by step.
First, see this plot:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a1_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;t_unit&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Household a1&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8eccad6e823e529e91401631dfc0999bb35965ca9b84784509b0c11faef3b284.svg" src="../_images/8eccad6e823e529e91401631dfc0999bb35965ca9b84784509b0c11faef3b284.svg" />
</div>
</div>
<p>Now, there are some data missing during Spring of 2019 and the dataframe is automatically interpolating.
We could change the style of the plot so that we see the individual data points.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a1_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;t_unit&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Household a1&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;.-&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2de47dc0c5a088581633e05afdcc8d6edda801da34d0ac424189c18ca8d15e25.svg" src="../_images/2de47dc0c5a088581633e05afdcc8d6edda801da34d0ac424189c18ca8d15e25.svg" />
</div>
</div>
<p>Sometimes, you may want to use your own figure object so that you can plot more stuff in it (e.g., titles, labels).
You can do this by passing the <code class="docutils literal notranslate"><span class="pre">ax</span></code> keyword argument:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">a1_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;t_unit&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Household a1&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Unit temperature (degrees F)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8ca27e41383343ed1236a8743ed933de1392dd0855a356b55ef8b7cf6c709399.svg" src="../_images/8ca27e41383343ed1236a8743ed933de1392dd0855a356b55ef8b7cf6c709399.svg" />
</div>
</div>
<p>And here is how you can add the temperature of another unit:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">a1_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;t_unit&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Household a1&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">b17_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;t_unit&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Household b17&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;d--&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Unit temperature (degrees F)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d32d66fa9fb8a67c3a68ded5b261424420eb55d8ca7c766e51d04061a08691de.svg" src="../_images/d32d66fa9fb8a67c3a68ded5b261424420eb55d8ca7c766e51d04061a08691de.svg" />
</div>
</div>
<section id="id1">
<h3>Questions<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>In the figure of <code class="docutils literal notranslate"><span class="pre">t_unit</span></code> vs <code class="docutils literal notranslate"><span class="pre">date</span></code> above, add data from household <code class="docutils literal notranslate"><span class="pre">c36</span></code>.</p></li>
<li><p>For households <code class="docutils literal notranslate"><span class="pre">a1</span></code>, <code class="docutils literal notranslate"><span class="pre">b17</span></code> and <code class="docutils literal notranslate"><span class="pre">c36</span></code> plot <code class="docutils literal notranslate"><span class="pre">hvac</span></code> as a function of the <code class="docutils literal notranslate"><span class="pre">date</span></code>. Hint: Change the keyword <code class="docutils literal notranslate"><span class="pre">y</span></code> in <code class="docutils literal notranslate"><span class="pre">Dataframe.plot()</span></code>.</p></li>
</ul>
</section>
</section>
<section id="avoid-writing-a-lot-of-code-by-using-loops">
<h2>Avoid writing a lot of code by using loops<a class="headerlink" href="#avoid-writing-a-lot-of-code-by-using-loops" title="Link to this heading">#</a></h2>
<p>So, far we manually extracted the data we need for each unit.
Now, I will show you how you can do it for as many usints as you like using a for loop.
Let’s redo our scatter plot for a list of households:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;hvac&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;All households&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>

<span class="c1"># Loop over household names</span>
<span class="k">for</span> <span class="n">household_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;a1&#39;</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">,</span> <span class="s1">&#39;a3&#39;</span><span class="p">,</span> <span class="s1">&#39;a4&#39;</span><span class="p">,</span> <span class="s1">&#39;a5&#39;</span><span class="p">]:</span>
    <span class="c1"># Extract the relevant data</span>
    <span class="n">df_tmp</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;household&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">household_name</span><span class="p">]</span>
    <span class="c1"># Plot the relevant data</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_tmp</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">],</span> <span class="n">df_tmp</span><span class="p">[</span><span class="s1">&#39;hvac&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Household &#39;</span> <span class="o">+</span> <span class="n">household_name</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t_out (F)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;hvac (kWh)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/40c3b0fc97bb0039b7c9bfa21d49d4b532070a712ce7afbdc61456ed990a36c3.svg" src="../_images/40c3b0fc97bb0039b7c9bfa21d49d4b532070a712ce7afbdc61456ed990a36c3.svg" />
</div>
</div>
<section id="id2">
<h3>Questions<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Modify the code above so that you plot the scatter plot for households <code class="docutils literal notranslate"><span class="pre">c34</span></code> to <code class="docutils literal notranslate"><span class="pre">c359</span></code>.</p></li>
<li><p>For the same households as above, plot <code class="docutils literal notranslate"><span class="pre">hvac</span></code> as a function of <code class="docutils literal notranslate"><span class="pre">date</span></code>.</p></li>
</ul>
</section>
</section>
<section id="extract-rows-that-satisfy-more-complicated-boolean-expressions">
<h2>Extract rows that satisfy more complicated boolean expressions<a class="headerlink" href="#extract-rows-that-satisfy-more-complicated-boolean-expressions" title="Link to this heading">#</a></h2>
<p>There is really no lilmit to how complicated the boolean expression you use can be.
Let me give you some examples.
Let’s say that we want to see how the selection of <code class="docutils literal notranslate"><span class="pre">t_unit</span></code> (temperature setpoint) affects energy consumption during the heating season.
We are on heating season for sure when the external temperature is smaller than 55 degrees F.
Okay, so we need to extract all the rows with <code class="docutils literal notranslate"><span class="pre">df['t_unit']</span> <span class="pre">&lt;</span> <span class="pre">55</span></code>.
Let’s do that:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_heating</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">55</span><span class="p">]</span>
<span class="n">df_heating</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>household</th>
      <th>date</th>
      <th>score</th>
      <th>t_out</th>
      <th>t_unit</th>
      <th>hvac</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a1</td>
      <td>2018-01-07</td>
      <td>100.0</td>
      <td>4.283373</td>
      <td>66.693229</td>
      <td>246.473231</td>
    </tr>
    <tr>
      <th>1</th>
      <td>a10</td>
      <td>2018-01-07</td>
      <td>100.0</td>
      <td>4.283373</td>
      <td>66.356134</td>
      <td>5.492116</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a11</td>
      <td>2018-01-07</td>
      <td>58.0</td>
      <td>4.283373</td>
      <td>71.549132</td>
      <td>402.094327</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a12</td>
      <td>2018-01-07</td>
      <td>64.0</td>
      <td>4.283373</td>
      <td>73.429514</td>
      <td>211.692244</td>
    </tr>
    <tr>
      <th>4</th>
      <td>a13</td>
      <td>2018-01-07</td>
      <td>100.0</td>
      <td>4.283373</td>
      <td>63.923937</td>
      <td>0.850536</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5643</th>
      <td>c44</td>
      <td>2020-02-25</td>
      <td>59.0</td>
      <td>43.642388</td>
      <td>76.494637</td>
      <td>19.135139</td>
    </tr>
    <tr>
      <th>5644</th>
      <td>c45</td>
      <td>2020-02-25</td>
      <td>87.0</td>
      <td>43.642388</td>
      <td>71.165052</td>
      <td>30.794281</td>
    </tr>
    <tr>
      <th>5646</th>
      <td>c47</td>
      <td>2020-02-25</td>
      <td>97.0</td>
      <td>43.642388</td>
      <td>68.603287</td>
      <td>5.339391</td>
    </tr>
    <tr>
      <th>5647</th>
      <td>c48</td>
      <td>2020-02-25</td>
      <td>92.0</td>
      <td>43.642388</td>
      <td>73.429239</td>
      <td>18.040078</td>
    </tr>
    <tr>
      <th>5649</th>
      <td>c50</td>
      <td>2020-02-25</td>
      <td>59.0</td>
      <td>43.642388</td>
      <td>77.716955</td>
      <td>14.405155</td>
    </tr>
  </tbody>
</table>
<p>2741 rows × 6 columns</p>
</div></div></div>
</div>
<p>Now, we are going to draw the same scatter plot, but we are going to color the points according to the unit temperature <code class="docutils literal notranslate"><span class="pre">t_unit</span></code>.
Let’s have pick the rows with <code class="docutils literal notranslate"><span class="pre">t_unit</span></code> between 70 and 72 degrees F.</p>
<div class="cell tag_raises-exception docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_heating_70to72</span> <span class="o">=</span> <span class="n">df_heating</span><span class="p">[</span><span class="n">df_heating</span><span class="p">[</span><span class="s1">&#39;t_unit&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">70</span> <span class="ow">and</span>
                               <span class="n">df_heating</span><span class="p">[</span><span class="s1">&#39;t_unit&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">72</span><span class="p">]</span>
<span class="n">df_heating_70to72</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">27</span><span class="o">-</span><span class="mi">2</span><span class="n">b2ecdc642cb</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">df_heating_70to72</span> <span class="o">=</span> <span class="n">df_heating</span><span class="p">[</span><span class="n">df_heating</span><span class="p">[</span><span class="s1">&#39;t_unit&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">70</span> <span class="ow">and</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span>                                <span class="n">df_heating</span><span class="p">[</span><span class="s1">&#39;t_unit&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">72</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">df_heating_70to72</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/site-packages/pandas/core/generic.py</span> in <span class="ni">__nonzero__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">1440</span>     <span class="nd">@final</span>
<span class="g g-Whitespace">   </span><span class="mi">1441</span>     <span class="k">def</span> <span class="nf">__nonzero__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">1442</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1443</span>             <span class="sa">f</span><span class="s2">&quot;The truth value of a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is ambiguous. &quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1444</span>             <span class="s2">&quot;Use a.empty, a.bool(), a.item(), a.any() or a.all().&quot;</span>

<span class="ne">ValueError</span>: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
</pre></div>
</div>
</div>
</div>
<p>The problem here is that the on the left and on the right of the logical <code class="docutils literal notranslate"><span class="pre">and</span></code> operator you have arrays of booleans not just booleans.
So, Python does not know what to do with them.
The correct operator to use to represent logical <code class="docutils literal notranslate"><span class="pre">AND</span></code> in this situation is <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> (which you can also read as <code class="docutils literal notranslate"><span class="pre">AND</span></code>).
Let’s try again.
This time we are going to get a really big error message.
I’m going to hide it.</p>
<div class="cell tag_hide-output tag_raises-exception docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_heating_70to72</span> <span class="o">=</span> <span class="n">df_heating</span><span class="p">[</span><span class="n">df_heating</span><span class="p">[</span><span class="s1">&#39;t_unit&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">70</span> <span class="o">&amp;</span>
                               <span class="n">df_heating</span><span class="p">[</span><span class="s1">&#39;t_unit&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">72</span><span class="p">]</span>
<span class="n">df_heating_70to72</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">~/opt/anaconda3/lib/python3.8/site-packages/pandas/core/ops/array_ops.py</span> in <span class="ni">na_logical_op</span><span class="nt">(x, y, op)</span>
<span class="g g-Whitespace">    </span><span class="mi">264</span>         <span class="c1">#  (xint or xbool) and (yint or bool)</span>
<span class="ne">--&gt; </span><span class="mi">265</span>         <span class="n">result</span> <span class="o">=</span> <span class="n">op</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">266</span>     <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/site-packages/pandas/core/ops/roperator.py</span> in <span class="ni">rand_</span><span class="nt">(left, right)</span>
<span class="g g-Whitespace">     </span><span class="mi">51</span> <span class="k">def</span> <span class="nf">rand_</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">52</span>     <span class="k">return</span> <span class="n">operator</span><span class="o">.</span><span class="n">and_</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">left</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">53</span> 

<span class="ne">TypeError</span>: ufunc &#39;bitwise_and&#39; not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule &#39;&#39;safe&#39;&#39;

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="nn">~/opt/anaconda3/lib/python3.8/site-packages/pandas/core/ops/array_ops.py</span> in <span class="ni">na_logical_op</span><span class="nt">(x, y, op)</span>
<span class="g g-Whitespace">    </span><span class="mi">278</span>             <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">279</span>                 <span class="n">result</span> <span class="o">=</span> <span class="n">libops</span><span class="o">.</span><span class="n">scalar_binop</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">op</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">280</span>             <span class="k">except</span> <span class="p">(</span>

<span class="nn">pandas/_libs/ops.pyx</span> in <span class="ni">pandas._libs.ops.scalar_binop</span><span class="nt">()</span>

<span class="ne">ValueError</span>: Buffer dtype mismatch, expected &#39;Python object&#39; but got &#39;double&#39;

<span class="n">The</span> <span class="n">above</span> <span class="n">exception</span> <span class="n">was</span> <span class="n">the</span> <span class="n">direct</span> <span class="n">cause</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span> <span class="n">exception</span><span class="p">:</span>

<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">28</span><span class="o">-</span><span class="mi">530</span><span class="n">d5ff944c3</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">df_heating_70to72</span> <span class="o">=</span> <span class="n">df_heating</span><span class="p">[</span><span class="n">df_heating</span><span class="p">[</span><span class="s1">&#39;t_unit&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">70</span> <span class="o">&amp;</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span>                                <span class="n">df_heating</span><span class="p">[</span><span class="s1">&#39;t_unit&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">72</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">df_heating_70to72</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/site-packages/pandas/core/ops/common.py</span> in <span class="ni">new_method</span><span class="nt">(self, other)</span>
<span class="g g-Whitespace">     </span><span class="mi">63</span>         <span class="n">other</span> <span class="o">=</span> <span class="n">item_from_zerodim</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">64</span> 
<span class="ne">---&gt; </span><span class="mi">65</span>         <span class="k">return</span> <span class="n">method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">66</span> 
<span class="g g-Whitespace">     </span><span class="mi">67</span>     <span class="k">return</span> <span class="n">new_method</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/site-packages/pandas/core/arraylike.py</span> in <span class="ni">__rand__</span><span class="nt">(self, other)</span>
<span class="g g-Whitespace">     </span><span class="mi">61</span>     <span class="nd">@unpack_zerodim_and_defer</span><span class="p">(</span><span class="s2">&quot;__rand__&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">62</span>     <span class="k">def</span> <span class="fm">__rand__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">63</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_logical_method</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">roperator</span><span class="o">.</span><span class="n">rand_</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">64</span> 
<span class="g g-Whitespace">     </span><span class="mi">65</span>     <span class="nd">@unpack_zerodim_and_defer</span><span class="p">(</span><span class="s2">&quot;__or__&quot;</span><span class="p">)</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/site-packages/pandas/core/series.py</span> in <span class="ni">_logical_method</span><span class="nt">(self, other, op)</span>
<span class="g g-Whitespace">   </span><span class="mi">4987</span>         <span class="n">rvalues</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">extract_numpy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4988</span> 
<span class="ne">-&gt; </span><span class="mi">4989</span>         <span class="n">res_values</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">logical_op</span><span class="p">(</span><span class="n">lvalues</span><span class="p">,</span> <span class="n">rvalues</span><span class="p">,</span> <span class="n">op</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4990</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_construct_result</span><span class="p">(</span><span class="n">res_values</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">res_name</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4991</span> 

<span class="nn">~/opt/anaconda3/lib/python3.8/site-packages/pandas/core/ops/array_ops.py</span> in <span class="ni">logical_op</span><span class="nt">(left, right, op)</span>
<span class="g g-Whitespace">    </span><span class="mi">353</span>         <span class="n">filler</span> <span class="o">=</span> <span class="n">fill_int</span> <span class="k">if</span> <span class="n">is_self_int_dtype</span> <span class="ow">and</span> <span class="n">is_other_int_dtype</span> <span class="k">else</span> <span class="n">fill_bool</span>
<span class="g g-Whitespace">    </span><span class="mi">354</span> 
<span class="ne">--&gt; </span><span class="mi">355</span>         <span class="n">res_values</span> <span class="o">=</span> <span class="n">na_logical_op</span><span class="p">(</span><span class="n">lvalues</span><span class="p">,</span> <span class="n">rvalues</span><span class="p">,</span> <span class="n">op</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">356</span>         <span class="c1"># error: Cannot call function of unknown type</span>
<span class="g g-Whitespace">    </span><span class="mi">357</span>         <span class="n">res_values</span> <span class="o">=</span> <span class="n">filler</span><span class="p">(</span><span class="n">res_values</span><span class="p">)</span>  <span class="c1"># type: ignore[operator]</span>

<span class="nn">~/opt/anaconda3/lib/python3.8/site-packages/pandas/core/ops/array_ops.py</span> in <span class="ni">na_logical_op</span><span class="nt">(x, y, op)</span>
<span class="g g-Whitespace">    </span><span class="mi">286</span>             <span class="p">)</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">287</span>                 <span class="n">typ</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
<span class="ne">--&gt; </span><span class="mi">288</span>                 <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">289</span>                     <span class="sa">f</span><span class="s2">&quot;Cannot perform &#39;</span><span class="si">{</span><span class="n">op</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; with a dtyped [</span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2">] array &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">290</span>                     <span class="sa">f</span><span class="s2">&quot;and scalar of type [</span><span class="si">{</span><span class="n">typ</span><span class="si">}</span><span class="s2">]&quot;</span>

<span class="ne">TypeError</span>: Cannot perform &#39;rand_&#39; with a dtyped [float64] array and scalar of type [bool]
</pre></div>
</div>
</div>
</details>
</div>
<p>The problem here is that Python is the order in which the expression is evaluated.
The operator <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> has a special meaning in Python (we are not going to get into it) and it has high priority.
So, python tries to evaluate first <code class="docutils literal notranslate"><span class="pre">68</span> <span class="pre">&amp;</span> <span class="pre">df_heating['t_unit']</span></code> which is meanigless.
What needs to happen here is that is should first evaluate <code class="docutils literal notranslate"><span class="pre">df_heating['t_unit']</span> <span class="pre">&gt;=</span> <span class="pre">68</span></code> to get an array of booleans, then evaluate <code class="docutils literal notranslate"><span class="pre">df_heating['t_unit']</span> <span class="pre">&lt;</span> <span class="pre">70</span></code> to get another array of booleans, and the use <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> to logically compare the arrays pointwise.
We can enforce this order using parentheses.
Whatever Python expression is enclosed in parentheses will be evaluated first.
So, here is the correct way to do it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_heating_70to72</span> <span class="o">=</span> <span class="n">df_heating</span><span class="p">[(</span><span class="n">df_heating</span><span class="p">[</span><span class="s1">&#39;t_unit&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">70</span><span class="p">)</span> <span class="o">&amp;</span>
                               <span class="p">(</span><span class="n">df_heating</span><span class="p">[</span><span class="s1">&#39;t_unit&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">72</span><span class="p">)]</span>
<span class="n">df_heating_70to72</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>household</th>
      <th>date</th>
      <th>score</th>
      <th>t_out</th>
      <th>t_unit</th>
      <th>hvac</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>a11</td>
      <td>2018-01-07</td>
      <td>58.0</td>
      <td>4.283373</td>
      <td>71.549132</td>
      <td>402.094327</td>
    </tr>
    <tr>
      <th>17</th>
      <td>b18</td>
      <td>2018-01-07</td>
      <td>87.0</td>
      <td>4.283373</td>
      <td>70.608333</td>
      <td>368.153883</td>
    </tr>
    <tr>
      <th>25</th>
      <td>b26</td>
      <td>2018-01-07</td>
      <td>97.0</td>
      <td>4.283373</td>
      <td>70.014178</td>
      <td>36.645884</td>
    </tr>
    <tr>
      <th>29</th>
      <td>b30</td>
      <td>2018-01-07</td>
      <td>99.0</td>
      <td>4.283373</td>
      <td>71.423206</td>
      <td>23.679263</td>
    </tr>
    <tr>
      <th>34</th>
      <td>c35</td>
      <td>2018-01-07</td>
      <td>96.0</td>
      <td>4.283373</td>
      <td>70.558912</td>
      <td>349.025111</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>And let’s plot the scatter plot highlighting the different unit temeprature ranges with different colors:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_heating</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">],</span> <span class="n">df_heating</span><span class="p">[</span><span class="s1">&#39;hvac&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;All households&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_heating_70to72</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">],</span> <span class="n">df_heating_70to72</span><span class="p">[</span><span class="s1">&#39;hvac&#39;</span><span class="p">],</span> 
           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;t_unit in [70, 72)&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t_out (F)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;hvac (kWh)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/109cbbd60f0e0b48a93c418d119852b26b2dc45eab3dc5ab51bb5aaed6261db3.svg" src="../_images/109cbbd60f0e0b48a93c418d119852b26b2dc45eab3dc5ab51bb5aaed6261db3.svg" />
</div>
</div>
<p>Let’s finish this section by demonstrating logical <code class="docutils literal notranslate"><span class="pre">OR</span></code> for selecting rows.
As you may have guessed <code class="docutils literal notranslate"><span class="pre">or</span></code> does not work.
We need to use the operator <code class="docutils literal notranslate"><span class="pre">|</span></code>.
And yes, we need to enclose everything in parentheses.
Let’s select the entries that exhibit bad energy consuming behavior.
That would be units that have a very high <code class="docutils literal notranslate"><span class="pre">t_unit</span></code> (say above 78) during heating or a very low <code class="docutils literal notranslate"><span class="pre">t_unit</span></code> during cooling (say below 70).
Let’s see how much energy they consume.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_bad_behavior</span> <span class="o">=</span> <span class="n">df</span><span class="p">[((</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">55</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t_unit&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">78</span><span class="p">))</span> <span class="o">|</span>
                     <span class="p">((</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">55</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t_unit&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">70</span><span class="p">))]</span>
<span class="n">df_bad_behavior</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>household</th>
      <th>date</th>
      <th>score</th>
      <th>t_out</th>
      <th>t_unit</th>
      <th>hvac</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>15</th>
      <td>a9</td>
      <td>2018-01-07</td>
      <td>39.0</td>
      <td>4.283373</td>
      <td>78.709433</td>
      <td>495.227311</td>
    </tr>
    <tr>
      <th>22</th>
      <td>b23</td>
      <td>2018-01-07</td>
      <td>44.0</td>
      <td>4.283373</td>
      <td>78.618808</td>
      <td>359.167522</td>
    </tr>
    <tr>
      <th>65</th>
      <td>a9</td>
      <td>2018-01-14</td>
      <td>41.0</td>
      <td>33.444172</td>
      <td>78.557192</td>
      <td>321.834468</td>
    </tr>
    <tr>
      <th>72</th>
      <td>b23</td>
      <td>2018-01-14</td>
      <td>43.0</td>
      <td>33.444172</td>
      <td>78.684325</td>
      <td>197.924672</td>
    </tr>
    <tr>
      <th>115</th>
      <td>a9</td>
      <td>2018-01-21</td>
      <td>41.0</td>
      <td>19.584102</td>
      <td>78.572321</td>
      <td>431.236407</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;hvac&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;All households&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_bad_behavior</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">],</span> <span class="n">df_bad_behavior</span><span class="p">[</span><span class="s1">&#39;hvac&#39;</span><span class="p">],</span> 
           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Bad behavior&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t_out (F)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;hvac (kWh)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2683aa97925b78a69dc61a62cccb194a86114caaaa56c3bdb634537c33bfd24d.svg" src="../_images/2683aa97925b78a69dc61a62cccb194a86114caaaa56c3bdb634537c33bfd24d.svg" />
</div>
</div>
<p>Notice that they are some entries that exhibit bad behavior without being penalized by excessive energy consumption.
This is because of a third variable that affects energy consumption, i.e., the location of the unit in the building.
Here is what is happening:</p>
<ul class="simple">
<li><p>Units that are at the corners of the building expose at least two sides to the external environment.</p></li>
<li><p>Units that are on the top floor expose at least two sides to the external environment.</p></li>
<li><p>Units that are at a corner and on the top floor expose three sides to the external environment.</p></li>
<li><p>The rest of the units expose a single side to the external environment.
The first three groups (and especially the third group) are loosing a lot of energy to the environment and their energy consumption will in general be higher.
The final group is basically insulated from the environment and on top of that they may be getting heat energy from their neighbors.
Behaving badly in a top floor, corner unit will be reflected on your energy bill.
Behaving badly in an insulated unit may have no effect on your energy bill.</p></li>
</ul>
<p>Let’s end with logical <code class="docutils literal notranslate"><span class="pre">NOT</span></code>.
Say we wanted to negate the previous selection so that we highlight all those who behaved well.
For this, you use the <code class="docutils literal notranslate"><span class="pre">~</span></code> operator in front of the logical expression you want to negate.
Like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_good_behavior</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="p">(((</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">55</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t_unit&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">78</span><span class="p">))</span> <span class="o">|</span>
                        <span class="p">((</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">55</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t_unit&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">70</span><span class="p">)))]</span>
<span class="n">df_bad_behavior</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>household</th>
      <th>date</th>
      <th>score</th>
      <th>t_out</th>
      <th>t_unit</th>
      <th>hvac</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>15</th>
      <td>a9</td>
      <td>2018-01-07</td>
      <td>39.0</td>
      <td>4.283373</td>
      <td>78.709433</td>
      <td>495.227311</td>
    </tr>
    <tr>
      <th>22</th>
      <td>b23</td>
      <td>2018-01-07</td>
      <td>44.0</td>
      <td>4.283373</td>
      <td>78.618808</td>
      <td>359.167522</td>
    </tr>
    <tr>
      <th>65</th>
      <td>a9</td>
      <td>2018-01-14</td>
      <td>41.0</td>
      <td>33.444172</td>
      <td>78.557192</td>
      <td>321.834468</td>
    </tr>
    <tr>
      <th>72</th>
      <td>b23</td>
      <td>2018-01-14</td>
      <td>43.0</td>
      <td>33.444172</td>
      <td>78.684325</td>
      <td>197.924672</td>
    </tr>
    <tr>
      <th>115</th>
      <td>a9</td>
      <td>2018-01-21</td>
      <td>41.0</td>
      <td>19.584102</td>
      <td>78.572321</td>
      <td>431.236407</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Again, pay attention to the parentheses because they are critical for the correct evaluation of the expression.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;hvac&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;All households&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_good_behavior</span><span class="p">[</span><span class="s1">&#39;t_out&#39;</span><span class="p">],</span> <span class="n">df_good_behavior</span><span class="p">[</span><span class="s1">&#39;hvac&#39;</span><span class="p">],</span> 
           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Good behavior&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t_out (F)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;hvac (kWh)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ebed6e204db0134b688e5db7f4f3b6a209148fd1ca1a8532cab7214656f0538f.svg" src="../_images/ebed6e204db0134b688e5db7f4f3b6a209148fd1ca1a8532cab7214656f0538f.svg" />
</div>
</div>
<section id="id3">
<h3>Questions<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The final histogram highlighting units with good behavior is not very useful because the range of <code class="docutils literal notranslate"><span class="pre">t_unit</span></code> temperatures we considered as good is too wide. Rerun the code block above using a narrower range of temperatures. Say a bad choice for heating is <code class="docutils literal notranslate"><span class="pre">t_unit</span></code> &gt; 72 and a bad for cooling is <code class="docutils literal notranslate"><span class="pre">t_unit</span></code> &lt; 75. Then, redo the scatter plot.</p></li>
</ul>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./lecture06"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="python-loops.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Python loops</p>
      </div>
    </a>
    <a class="right-next"
       href="homework_06.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Homework 6</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-rows-that-satisfy-single-boolean-expression">Extract rows that satisfy single boolean expression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#questions">Questions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-timeseries-data">Plotting timeseries data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Questions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#avoid-writing-a-lot-of-code-by-using-loops">Avoid writing a lot of code by using loops</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Questions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-rows-that-satisfy-more-complicated-boolean-expressions">Extract rows that satisfy more complicated boolean expressions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Questions</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Ilias Bilionis (ibilion[at]purdue.edu)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>